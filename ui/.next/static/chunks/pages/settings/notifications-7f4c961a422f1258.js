(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[742],{39863:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/notifications",function(){return n(42139)}])},42139:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var l=n(37876),s=n(12701),a=n(31974),i=n(95932),c=n(40556),d=n(54587),o=n.n(d),r=n(14232),u=n(89848),m=n(41568),f=n(46100),h=n(10850),x=n(10196),p=n(10291),b=n(11684),v=n(66964);let g=e=>{var t,n,s;let[a,i]=(0,r.useState)(),[c,d]=(0,r.useState)(),o=(0,r.useRef)(""),f=(0,r.useRef)(3),g=(0,r.useRef)(!1),[j,N]=(0,r.useState)(),[y,w]=(0,r.useState)(),[S,k]=(0,r.useState)([]);(0,r.useEffect)(()=>{(0,m.Ay)("/notifications/agents").then(t=>{i([{name:"-",options:[]},...t]),e.selected&&e.selected.agent&&w(t.find(t=>e.selected.agent===t.name))}),(0,m.Ay)("/notifications/types").then(t=>{d(t),e.selected&&e.selected.types&&k(t.filter(t=>e.selected.types.includes(t.id)))}),e.selected&&(o.current=e.selected.name,g.current=e.selected.enabled,N(e.selected.options))},[]);let A=(e,t)=>{N(n=>({...n,[e]:t}))};return a&&c?(0,l.jsx)(b.A,{loading:!1,backgroundClickable:!1,onCancel:()=>e.onCancel(),okDisabled:!1,okText:"Save",okButtonType:"primary",title:(null==(t=e.selected)?void 0:t.id)?"Edit Notification Agent":"New Notification Agent",iconSvg:"",onOk:()=>{let t=S?S.map(e=>e.id):[];if(y&&""!==o.current){var n,l;l={id:null==(n=e.selected)?void 0:n.id,name:o.current,agent:y.name,enabled:g.current,types:t,aboutScale:f.current,options:j},(0,m.vI)("/notifications/configuration/add",l).then(t=>{e.onSave("OK"===t.status)})}else e.onSave(!1)},secondaryButtonType:"success",secondaryText:"Test",onSecondary:()=>{if(y&&""!==o.current){var t;let n=S?S.map(e=>e.id):[];(0,m.vI)("/notifications/test",{id:null==(t=e.selected)?void 0:t.id,name:o.current,agent:y.name,enabled:g.current,types:n,aboutScale:f.current,options:j}).then(e=>{"Success"!==e?u.oR.error(e,{autoClose:1e4}):u.oR.success("Successfully fired the notification!")})}},children:(0,l.jsx)("div",{children:(0,l.jsxs)("form",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsx)("label",{htmlFor:"name",className:"text-label",children:"Name *"}),(0,l.jsx)("div",{className:"form-input",children:(0,l.jsx)("div",{className:"form-input-field",children:(0,l.jsx)("input",{type:"text",id:"name",name:"name",defaultValue:null==(n=e.selected)?void 0:n.name,onChange:e=>o.current=e.target.value})})})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsx)("label",{htmlFor:"enabled",className:"text-label",children:"Enabled"}),(0,l.jsx)("div",{className:"form-input",children:(0,l.jsx)("div",{className:"form-input-field",children:(0,l.jsx)("input",{type:"checkbox",name:"enabled",id:"enabled",defaultChecked:null==(s=e.selected)?void 0:s.enabled,onChange:e=>g.current=e.target.checked})})})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsx)("label",{htmlFor:"agent",className:"text-label",children:"Agent *"}),(0,l.jsx)("div",{className:"form-input",children:(0,l.jsx)("div",{className:"form-input-field",children:(0,l.jsx)("select",{id:"agent",name:"agent",onChange:e=>{N({}),w(a[Number(e.target.value)])},className:"rounded-l-only",children:null==a?void 0:a.map((t,n)=>{var s;return(0,l.jsx)("option",{value:n,selected:!!e.selected&&t.name===(null==(s=e.selected)?void 0:s.agent),children:"".concat(t.friendlyName?t.friendlyName:"")},"agent-".concat(n))})})})})]}),(0,l.jsxs)("div",{children:[null==y?void 0:y.options.map(e=>(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("label",{htmlFor:"".concat(y.name,"-").concat(e.field),className:"text-label",children:[(0,x.xD)(e.field+(e.required?" *":"")),e.extraInfo?(0,l.jsx)("span",{className:"label-tip",children:e.extraInfo}):null]}),(0,l.jsx)("div",{className:"form-input",children:(0,l.jsx)("div",{className:"form-input-field",children:"json"===e.type?(0,l.jsx)(h.KE,{height:"200px",defaultLanguage:"json",theme:"vs-dark",defaultValue:(null==j?void 0:j[e.field])?JSON.stringify(null==j?void 0:j[e.field],null,2):"{}",options:{minimap:{enabled:!1},formatOnPaste:!0,formatOnType:!0},onChange:t=>A(e.field,t?JSON.parse(t):{})}):(0,l.jsx)("input",{name:e.field,id:"".concat(y.name,"-").concat(e.field),type:e.type,required:e.required,defaultValue:(null==j?void 0:j[e.field])?null==j?void 0:j[e.field]:void 0,defaultChecked:"checkbox"==e.type&&(null==j?void 0:j[e.field]),onChange:t=>{"checkbox"==e.type?A(e.field,t.target.checked):A(e.field,t.target.value)}},"".concat(y.name,"-option-").concat(e.field))})})]},"form-row-".concat(e.field))),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsx)("label",{className:"text-label",children:"Types *"}),(0,l.jsx)("div",{className:"form-input",children:c.map(t=>{var n,s;return(0,l.jsxs)("div",{children:[(0,l.jsx)(v.A,{label:t.title,toggled:null==(n=e.selected)?void 0:n.types.includes(t.id),onStateChange:e=>{e?k([...S,t]):k(S.filter(e=>e.id!==t.id))}}),S.find(e=>8===e.id)&&8===t.id&&(0,l.jsxs)("div",{className:"form-row mb-0 ml-9 mt-0",children:[(0,l.jsx)("label",{htmlFor:"about-scale",className:"text-label",children:"Notify x days before removal"}),(0,l.jsx)("div",{className:"form-input",children:(0,l.jsx)("div",{className:"form-input-field",children:(0,l.jsx)("input",{type:"number",name:"about-scale",defaultValue:(null==(s=e.selected)?void 0:s.aboutScale)||f.current,onChange:e=>f.current=+e.target.value})})})]})]},t.id)})})]})]})]})})}):(0,l.jsx)("span",{children:(0,l.jsx)(p.A,{})})};var j=n(65364);let N=e=>{let{onDeleteRequested:t}=e,[n,s]=(0,r.useState)(!1);return(0,l.jsxs)(f.A,{buttonSize:"md",buttonType:"twin-secondary-r",className:"h-10 w-1/2",onClick:()=>{n?(t(),s(!1)):s(!0)},children:[(0,l.jsx)(c.A,{className:"m-auto"})," ",(0,l.jsx)("p",{className:"m-auto font-semibold",children:n?(0,l.jsx)(l.Fragment,{children:"Are you sure?"}):(0,l.jsx)(l.Fragment,{children:"Delete"})})]})},y=()=>{var e;let[t,n]=(0,r.useState)(!1),[s,c]=(0,r.useState)(),[d,h]=(0,r.useState)(),x=null!=(e=j.env.NEXT_PUBLIC_BASE_PATH)?e:"";(0,r.useEffect)(()=>{document.title="Maintainerr - Settings - Notifications",(0,m.Ay)("/notifications/configurations").then(e=>c(e))},[]);let p=e=>{n(e),(0,m.Ay)("/notifications/configurations").then(e=>c(e))};return(0,l.jsxs)("div",{className:"h-full w-full",children:[(0,l.jsxs)("div",{className:"mb-5 mt-6 h-full w-full text-white",children:[(0,l.jsxs)("h3",{className:"heading flex items-center gap-2",children:["Notification Settings",(0,l.jsx)(o(),{className:"h-[1em] w-[2.5em]",width:"0",height:"0",src:"".concat(x,"/beta.svg"),alt:"BETA"})]}),(0,l.jsx)("p",{className:"description",children:"Notification Agent configuration"})]}),(0,l.jsx)("div",{children:(0,l.jsxs)("ul",{className:"grid max-w-6xl grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3",children:[null==s?void 0:s.map(e=>(0,l.jsxs)("li",{className:"h-full rounded-xl bg-zinc-800 p-4 text-zinc-400 shadow ring-1 ring-zinc-700",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center gap-x-3",children:[(0,l.jsx)("div",{className:"text-base font-bold text-white sm:text-lg",children:e.name}),!e.enabled&&(0,l.jsx)("div",{className:"rounded bg-amber-600 px-2 py-0.5 text-xs text-zinc-200 shadow-md",children:"Disabled"})]}),(0,l.jsx)("p",{className:"mb-4 space-x-2 truncate text-gray-300",children:(0,l.jsx)("span",{className:"font-semibold",children:e.agent})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)(f.A,{buttonType:"twin-primary-l",buttonSize:"md",className:"h-10 w-1/2",onClick:()=>{var n;e.id&&(n=e.id,h(null==s?void 0:s.find(e=>e.id===n)),p(!t))},children:[(0,l.jsx)(a.A,{className:"m-auto"})," ",(0,l.jsx)("p",{className:"m-auto font-semibold",children:"Edit"})]}),(0,l.jsx)(N,{onDeleteRequested:()=>(function(e){(0,m.su)("/notifications/configuration/".concat(e)).then(()=>{c(null==s?void 0:s.filter(t=>t.id!==e))})})(e.id)})]})]},e.id)),(0,l.jsx)("li",{className:"flex h-full items-center justify-center rounded-xl border-2 border-dashed border-gray-400 bg-zinc-800 p-4 text-zinc-400 shadow",children:(0,l.jsxs)("button",{type:"button",className:"add-button m-auto flex h-9 rounded bg-amber-600 px-4 text-zinc-200 shadow-md hover:bg-amber-500",onClick:()=>p(!t),children:[(0,l.jsx)(i.A,{className:"m-auto h-5"}),(0,l.jsx)("p",{className:"m-auto ml-1 font-semibold",children:"Add Agent"})]})})]})}),t?(0,l.jsx)(g,{onCancel:()=>{p(!t),h(void 0)},onSave:e=>{p(!t),h(void 0),e?u.oR.success("Successfully saved notification agent"):u.oR.error("Didn't save incomplete notification agent")},onTest:()=>{},...d?{selected:{id:d.id,name:d.name,enabled:d.enabled,agent:d.agent,types:d.types,options:d.options,aboutScale:d.aboutScale}}:{}}):null]})},w=()=>(0,l.jsx)(s.A,{children:(0,l.jsx)(y,{})})},66964:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var l=n(37876),s=n(14232);let a=e=>{let{label:t,toggled:n,onStateChange:a}=e,[i,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{void 0!==n&&c(n)},[]),(0,l.jsx)("div",{className:"flex items-center justify-between border-b border-gray-700 py-2",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",checked:i,onChange:()=>{a(!i),c(!i)}}),(0,l.jsx)("span",{className:"toggle-label block h-6 cursor-pointer overflow-hidden rounded-full bg-gray-400"}),(0,l.jsx)("span",{className:"ml-3 text-white",children:t})]})})}}},e=>{e.O(0,[488,572,636,593,792],()=>e(e.s=39863)),_N_E=e.O()}]);