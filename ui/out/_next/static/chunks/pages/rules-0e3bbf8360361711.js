(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93],{1660:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"}))})},6555:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))})},10815:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>eC});var a=l(37876),s=l(48711),r=l(14232),n=l(89848),i=function(e){return e[e.BIGGER=0]="BIGGER",e[e.SMALLER=1]="SMALLER",e[e.EQUALS=2]="EQUALS",e[e.NOT_EQUALS=3]="NOT_EQUALS",e[e.CONTAINS=4]="CONTAINS",e[e.BEFORE=5]="BEFORE",e[e.AFTER=6]="AFTER",e[e.IN_LAST=7]="IN_LAST",e[e.IN_NEXT=8]="IN_NEXT",e[e.NOT_CONTAINS=9]="NOT_CONTAINS",e[e.CONTAINS_PARTIAL=10]="CONTAINS_PARTIAL",e[e.NOT_CONTAINS_PARTIAL=11]="NOT_CONTAINS_PARTIAL",e[e.CONTAINS_ALL=12]="CONTAINS_ALL",e[e.NOT_CONTAINS_ALL=13]="NOT_CONTAINS_ALL",e[e.COUNT_EQUALS=14]="COUNT_EQUALS",e[e.COUNT_NOT_EQUALS=15]="COUNT_NOT_EQUALS",e[e.COUNT_BIGGER=16]="COUNT_BIGGER",e[e.COUNT_SMALLER=17]="COUNT_SMALLER",e}({});let o={0:"Bigger",1:"Smaller",2:"Equals",3:"Not Equals",4:"Contains (Exact list match)",5:"Before",6:"After",7:"In Last",8:"In Next",9:"Not Contains (Exact list match)",10:"Contains (Partial list match)",11:"Not Contains (Partial list match)",12:"Contains (All items)",13:"Not Contains (All items)",14:"Count Equals",15:"Count Does Not Equal",16:"Count Is Bigger Than",17:"Count Is Smaller Than"};var c=function(e){return e[e.BOTH=0]="BOTH",e[e.MOVIE=1]="MOVIE",e[e.SHOW=2]="SHOW",e}({}),d=function(e){return e[e.PLEX=0]="PLEX",e[e.RADARR=1]="RADARR",e[e.SONARR=2]="SONARR",e[e.OVERSEERR=3]="OVERSEERR",e[e.TAUTULLI=4]="TAUTULLI",e}({});let m=(0,r.createContext)({constants:{},setConstants:e=>{},removeConstants:()=>{}});function u(e){let[t,l]=(0,r.useState)({applications:null});return(0,a.jsx)(m.Provider,{value:{constants:t,setConstants:function(e){l(e)},removeConstants:function(){l({})}},children:e.children})}var x=l(37408),h=l(41568),f=l(95932);let v=e=>(0,a.jsxs)("button",{className:"add-button m-auto flex h-9 rounded bg-amber-600 text-zinc-200 shadow-md hover:bg-amber-500",onClick:e.onClick,children:[(0,a.jsx)(f.A,{className:"m-auto ml-4 h-5"}),(0,a.jsx)("p",{className:"rules-button-text m-auto ml-1 mr-4",children:e.text})]});var p=l(98587),b=l(91710),g=l(10291);let j=e=>(0,a.jsx)("button",{className:"right-5 m-auto flex h-8 w-full rounded-t bg-amber-600 text-zinc-200 shadow-md hover:bg-amber-500 xl:rounded-l xl:rounded-r-none",onClick:e.onClick,children:(0,a.jsxs)("div",{className:"m-auto ml-auto flex",children:[e.svgIcon,(0,a.jsx)("p",{className:"button-text m-auto ml-1 text-zinc-200",children:e.text})]})}),y=e=>(0,a.jsx)("button",{className:"right-5 m-auto flex h-8 w-full rounded-b bg-amber-900 text-white shadow-md hover:bg-amber-800 xl:rounded-l-none xl:rounded-r",onClick:e.onClick,children:(0,a.jsxs)("div",{className:"m-auto ml-auto flex",children:[e.svgIcon?e.svgIcon:void 0,(0,a.jsx)("p",{className:"button-text m-auto ml-1 text-zinc-200",children:e.text})]})});var N=l(91104);let w=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"}))});var C=l(40556);let S=e=>{var t,l;let[s,n]=(0,r.useState)(!1),i=(0,r.useContext)(N.A);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"inset-0 z-0 h-fit p-3",children:[(0,a.jsx)("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap text-base font-bold text-white sm:text-lg",children:(0,a.jsx)("div",{children:e.group.name})}),(0,a.jsx)("div",{className:"h-12 max-h-12 overflow-y-hidden whitespace-normal text-base text-zinc-400 hover:overflow-y-scroll",children:e.group.description})]}),(0,a.jsxs)("div",{className:"inset-0 z-0 h-fit p-3",children:[(0,a.jsxs)("div",{className:"mb-5 mt-5 grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"align-center flex justify-center font-bold",children:"Status"}),(0,a.jsx)("div",{children:e.group.isActive?(0,a.jsx)("span",{className:"flex justify-center text-green-500",children:"Active"}):(0,a.jsx)("span",{className:"flex justify-center text-red-500",children:"Inactive"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"m-auto mr-2 flex justify-center font-bold",children:"Library"}),(0,a.jsx)("div",{className:"flex justify-center text-amber-500",children:"".concat(null!=(l=null==(t=i.libraries.find(t=>+t.key==+e.group.libraryId))?void 0:t.title)?l:"")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"m-auto mr-2 flex justify-center font-bold",children:"Rules"}),(0,a.jsx)("div",{className:"flex justify-center text-amber-500",children:e.group.rules.length})]})]}),(0,a.jsxs)("div",{className:"grid w-full grid-cols-1 xl:grid-cols-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)(j,{onClick:()=>{e.onEdit(e.group)},text:"Edit",svgIcon:(0,a.jsx)(w,{className:"m-auto h-5 text-zinc-200"})})}),(0,a.jsx)("div",{children:s?(0,a.jsx)(y,{onClick:()=>{(0,h.su)("/rules/".concat(e.group.id)).then(t=>{1===t.code?e.onDelete():console.log("Error while deleting Rulegroup")}).catch(e=>{console.log(e)})},text:"Are you sure?"}):(0,a.jsx)(y,{onClick:()=>{n(!0)},text:"Delete",svgIcon:(0,a.jsx)(C.A,{className:"m-auto h-5 text-zinc-200"})})})]})]})]})},A=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"}))}),k=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}))});var T=l(33444);let z=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"}))});var _=l(57353);let R=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z",clipRule:"evenodd"}))});var E=l(54587),O=l.n(E),I=l(89099),L=l.n(I),D=l(94035),M=l(36572),U=l(46100);let F=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,B=e=>{if("string"!=typeof e)throw TypeError("Invalid argument expected string");let t=e.match(F);if(!t)throw Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},V=e=>"*"===e||"x"===e||"X"===e,P=e=>{let t=parseInt(e,10);return isNaN(t)?e:t},H=(e,t)=>{if(V(e)||V(t))return 0;let[l,a]=((e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t])(P(e),P(t));return l>a?1:l<a?-1:0},X=(e,t)=>{for(let l=0;l<Math.max(e.length,t.length);l++){let a=H(e[l]||"0",t[l]||"0");if(0!==a)return a}return 0},J={0:"Plex",1:"Radarr",2:"Sonarr",3:"Overseerr",4:"Tautulli",5:"Jellyseerr"};var W=l(11684);let G=e=>{let t=(0,r.useRef)(void 0),l=(0,r.useRef)(void 0),s=(0,r.useRef)(void 0),[n,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),d=async()=>{if(t.current.value&&l.current.value){let a=function(e){let t=new Set;for(let l of e){let[e]=l.firstVal;if(t.add(Number(e)),l.lastVal){let[e]=l.lastVal;t.add(Number(e))}}return Array.from(t).map(e=>J[e]).filter(e=>!!e)}(e.rules),r={name:t.current.value,type:e.type,description:l.current.value,JsonRules:e.rules,uploadedBy:s.current.value||void 0,requiredServices:a};"show"===e.type&&e.level&&(r.level=e.level),await (0,h.vI)("/rules/community",r).then(e=>{1===e.code?i(!0):c(e.result)}).catch(e=>{c("Failed to connect to the server. Please try again later.")})}};return(0,a.jsx)("div",{children:(0,a.jsxs)(W.A,{loading:!1,backgroundClickable:!1,onCancel:e.onCancel,cancelText:"Cancel",okDisabled:!1,onOk:d,okText:"Upload",okButtonType:"primary",title:"Upload Community Rule",iconSvg:"",children:[(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)(M.A,{title:"Every attempt should be made to only upload working rules.\n                    Rules with less than -100 karma and uploads with no rules, are removed nightly.",type:"warning"}),o?(0,a.jsx)(M.A,{title:"Error: ".concat(o),type:"warning"}):void 0,(0,a.jsxs)("form",{children:[(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsx)("label",{htmlFor:"name",className:"text-label",children:"Community Short Name *"}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{className:"!bg-zinc-800",name:"name",id:"name",type:"text",ref:t})})})]}),(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsx)("label",{htmlFor:"description",className:"text-label",children:"Extended Description *"}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("textarea",{className:"!bg-zinc-800",name:"description",id:"description",rows:5,ref:l})})})]}),(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsx)("label",{htmlFor:"uploadedBy",className:"text-label",children:"Uploaded by (optional)"}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field items-center",children:(0,a.jsx)("input",{className:"!bg-zinc-800",name:"uploadedBy",id:"uploadedBy",type:"text",maxLength:20,placeholder:"Max 20 characters",ref:s})})})]})]})]}),n?(0,a.jsx)(W.A,{loading:!1,backgroundClickable:!1,onCancel:()=>{i(!1),e.onSubmit()},cancelText:"Close",title:"Upload Successful",iconSvg:"",children:(0,a.jsx)(M.A,{title:"Thank you for contributing.",type:"info"})}):void 0]})})},Y=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"}))}),Q=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"}))}),q=e=>(0,a.jsxs)("tr",{className:e.clicked?"bg-zinc-600":"",children:[(0,a.jsx)("td",{onClick:()=>{e.onClick&&e.onClick(e.rule.id)},onDoubleClick:()=>{e.onDoubleClick&&e.onDoubleClick(e.rule.id)},className:"whitespace-wrap inline-block max-h-44 w-60 overflow-hidden overflow-ellipsis px-4 py-4 text-left text-sm leading-5 text-white md:w-96",children:e.rule.name}),(0,a.jsx)("td",{className:"px-4 py-4 text-center text-sm leading-5 text-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",title:e.thumbsActive?"":"You have already submitted karma for this rule.",children:[(0,a.jsx)(Y,{onClick:e.thumbsActive&&void 0!==e.rule.karma&&e.rule.karma<990?()=>{e.onThumbsUp&&e.onThumbsUp(e.rule.id)}:void 0,className:e.thumbsActive&&void 0!==e.rule.karma&&e.rule.karma<990?"w-6 cursor-pointer hover:text-amber-700":"w-6 text-zinc-700"}),e.rule.karma,(0,a.jsx)(Q,{onClick:e.thumbsActive?()=>{e.onThumbsDown&&e.onThumbsDown(e.rule.id)}:void 0,className:e.thumbsActive?"w-6 cursor-pointer hover:text-amber-700":"w-6 text-zinc-700"})]})}),(0,a.jsx)("td",{className:"px-4 py-4 text-center text-sm leading-5 text-white",children:e.rule.uploadedBy?e.rule.uploadedBy:"?"}),(0,a.jsx)("td",{className:"px-4 py-4 text-center text-sm leading-5 text-white",children:e.rule.appVersion?e.rule.appVersion:"?"})]});var K=l(1660);let $=e=>(0,a.jsxs)("button",{disabled:void 0!==e.enabled&&!e.enabled,className:"mb-2 flex h-9 w-24 rounded bg-zinc-900 text-zinc-200 shadow-md hover:bg-zinc-800 disabled:opacity-50 md:ml-2",onClick:e.onClick,children:[(0,a.jsx)(K.A,{className:"m-auto ml-5 h-5"})," ",(0,a.jsx)("p",{className:"rules-button-text m-auto ml-1 mr-5",children:e.text})]}),Z=e=>(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("span",{className:"mb-2 text-sm text-zinc-200",children:["Showing"," ",(0,a.jsx)("span",{className:"font-bold text-zinc-400",children:0===e.totalItems?0:(e.currentPage-1)*e.pageSize+1})," ","to"," ",(0,a.jsx)("span",{className:"font-bold text-zinc-400",children:e.currentPage*e.pageSize>=e.totalItems?e.totalItems:e.currentPage*e.pageSize})," ","of ",(0,a.jsx)("span",{className:"font-bold text-zinc-400",children:e.totalItems})," ","Rules"]}),(0,a.jsxs)("div",{className:"inline-flex xs:mt-0",children:[1===e.currentPage?void 0:(0,a.jsxs)("button",{onClick:()=>e.handleBackward(),className:"rounded-l bg-zinc-900 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-800",children:["Prev"," "]}),e.currentPage*e.pageSize>=e.totalItems?void 0:(0,a.jsx)("button",{onClick:()=>e.handleForward(),className:"rounded-r border-0 border-l border-gray-700 bg-zinc-900 px-4 py-2 text-sm font-medium text-white hover:bg-zinc-800",children:"Next"})]})]});var ee=l(43877);let et=e=>{var t;let[l,s]=(0,r.useState)([]),[n,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!0),[d,m]=(0,r.useState)(1),[u,x]=(0,r.useState)(),[f,v]=(0,r.useState)([]),[p,b]=(0,r.useState)(!1),[j,y]=(0,r.useState)(!1),[N,w]=(0,r.useState)("0.0.0"),[C,S]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{c(!0),i(!1);let e=A(),t=(0,h.Ay)("/rules/community").then(e=>{if(Array.isArray(e))s(e);else throw Error("Couldn't fetch community rules.")}),l=k();await Promise.all([e,t,l]).catch(e=>{i(!0),console.error(e)}).finally(()=>{c(!1)})})()},[]);let A=async()=>(0,h.Ay)("/settings/version").then(e=>{if(e)w(e);else throw Error("Couldn't fetch app version.")}),k=async()=>(0,h.Ay)("/rules/community/karma/history").then(e=>{if(e)v(e);else throw Error("Couldn't fetch community rule Karma history.")}),T=(0,r.useMemo)(()=>l.filter(t=>{let l=0>=((e,t)=>{let l=B(e),a=B(t),s=l.pop(),r=a.pop(),n=X(l,a);return 0!==n?n:s&&r?X(s.split("."),r.split(".")):s||r?s?-1:1:0})(t.appVersion||"0.0.0",N),a=t.type===e.type;return l&&a}).sort((e,t)=>t.karma-e.karma),[l,N,e.type]),_=(0,r.useMemo)(()=>T.filter(e=>{var t;return""===C||e.name.toLowerCase().includes(C.trim().toLowerCase())||e.description.toLowerCase().includes(C.trim().toLowerCase())||(null==(t=e.uploadedBy)?void 0:t.toLowerCase().includes(C.trim().toLowerCase()))}),[T,C]),R=(0,r.useMemo)(()=>_.slice((d-1)*5,5*d),[_,d,5]),E=Math.max(1,Math.ceil(_.length/5));d>E&&m(E);let O=e=>{m(e)},I=e=>{u!==e?x(e):x(void 0)},L=async(e,t)=>{let a=l.find(t=>t.id===e);(null==a?void 0:a.karma)!=null&&1===await (0,h.vI)("/rules/community/karma",{id:e,karma:a.karma+t}).then(e=>+(0!==e.code)).catch(()=>0)&&(s(l.map(l=>{let a={...l};return a.id===e&&void 0!==a.karma&&(a.karma+=t),a})),v([{id:f.length,community_rule_id:e},...f]))};return(0,a.jsx)("div",{children:(0,a.jsxs)(W.A,{loading:!1,backgroundClickable:!1,onCancel:e.onCancel,size:"5xl",okDisabled:null==u,onOk:()=>{if(void 0!==e.onUpdate&&null!=u){let t=l.find(e=>e.id===u);void 0!==t&&e.onUpdate(t.JsonRules)}},okText:"Import",okButtonType:"primary",title:"Community Rules",iconSvg:"",children:[(0,a.jsx)("div",{children:(0,a.jsx)(M.A,{type:"info",children:"Import rules made by the community. This will override your current rules."})}),(0,a.jsx)(ee.A,{onSearch:e=>S(e)}),o?(0,a.jsx)(g.A,{}):(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"-mx-4 overflow-x-auto md:mx-0 lg:mx-0",children:(0,a.jsx)("div",{className:"inline-block min-w-full py-2 align-middle",children:(0,a.jsx)("div",{className:"overflow-hidden shadow md:mx-0 lg:mx-0",children:(0,a.jsx)("table",{className:"ml-2 mr-2 min-w-full table-fixed",children:(0,a.jsxs)("tbody",{className:"divide-y divide-zinc-600 bg-zinc-800",children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"w-60 truncate bg-gray-500 px-4 py-3 text-xs font-medium uppercase text-gray-200 md:w-80",children:(0,a.jsx)("span",{children:"Name"})}),(0,a.jsx)("th",{className:"truncate bg-gray-500 text-center text-xs font-medium uppercase text-gray-200",children:(0,a.jsx)("span",{children:"Karma"})}),(0,a.jsx)("th",{className:"truncate bg-gray-500 px-3 text-center text-xs font-medium uppercase text-gray-200",children:(0,a.jsx)("span",{children:"Uploaded By"})}),(0,a.jsx)("th",{className:"truncate bg-gray-500 px-3 text-center text-xs font-medium uppercase text-gray-200",children:(0,a.jsx)("span",{children:"Made with Version"})})]}),n?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"px-4 py-4 text-center font-semibold text-amber-500",children:"An error occurred fetching community rules. Please try again later."})}):(0,a.jsx)(a.Fragment,{children:0===T.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"px-4 py-4 text-center text-white",children:"No community rules found for this type & Maintainerr version."})}):(0,a.jsx)(a.Fragment,{children:0===R.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"px-4 py-4 text-center text-white",children:"No community rules found for this search."})}):(0,a.jsx)(a.Fragment,{children:R.map((e,t)=>(0,a.jsx)(q,{clicked:u===e.id,onClick:I,onDoubleClick:()=>b(!0),thumbsActive:void 0===f.find(t=>t.community_rule_id===e.id),onThumbsUp:e=>L(e,10),onThumbsDown:e=>L(e,-10),rule:e},t))})})})]})})})})}),(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("span",{className:"float-left",children:(0,a.jsx)($,{text:"Info",enabled:null!=u,onClick:()=>b(!0)})}),(0,a.jsx)("span",{className:"float-right",children:(0,a.jsxs)("button",{disabled:!1,className:"mb-2 flex h-9 w-fit rounded bg-zinc-900 text-zinc-200 shadow-md hover:bg-zinc-800 disabled:opacity-50 md:ml-2",onClick:()=>{y(!0)},children:[(0,a.jsx)(z,{className:"m-auto ml-5 h-5"})," ",(0,a.jsx)("p",{className:"rules-button-text m-auto ml-1 mr-5",children:"Upload my rules"})]})})]}),(0,a.jsx)(Z,{totalItems:_.length,currentPage:d,pageSize:5,handleForward:()=>O(d+1),handleBackward:()=>O(d-1)})]}),p?(0,a.jsx)(W.A,{loading:!1,onCancel:()=>b(!1),cancelText:"Close",title:"Community Rule Description",iconSvg:"",children:(0,a.jsx)("div",{className:"block max-h-full w-full max-w-full overflow-auto bg-zinc-600 p-3 text-zinc-200",children:null==(t=l.find(e=>e.id===u))?void 0:t.description})}):void 0,j?(0,a.jsx)(G,{onCancel:()=>y(!1),onSubmit:()=>{y(!1),e.onCancel()},type:e.type,rules:e.currentRules?e.currentRules:[],level:"show"===e.type?e.level:void 0}):void 0]})})},el=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"}))});var ea=l(90525),es=l(10850);let er=e=>{let t=(0,r.useRef)(void 0),l=(0,r.useRef)(null),s=async()=>{if(e.yaml){let t=new Blob([e.yaml],{type:"text/yaml"}),l=URL.createObjectURL(t),a=document.createElement("a");a.href=l,a.download="maintainerr_rules_".concat(new Date().getTime(),".yaml"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},i=async()=>{var e,l;let a=null==(l=t.current)||null==(e=l.getValue)?void 0:e.call(l);if(null==a?void 0:a.trim())try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(a);else throw Error("Clipboard not available");n.oR.success("Copied to clipboard")}catch(e){try{let e=document.createElement("textarea");e.value=a,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e),n.oR.success("Copied to clipboard")}catch(e){n.oR.error("Failed to copy to clipboard")}}};return(0,a.jsx)("div",{children:(0,a.jsxs)(W.A,{loading:!1,backgroundClickable:!1,onCancel:()=>e.onCancel(),okDisabled:!1,onOk:e.yaml?()=>s():()=>e.onImport(t.current.getValue()),okText:e.yaml?"Download":"Import",okButtonType:"primary",title:"Yaml Rule Editor",iconSvg:"",children:[(0,a.jsx)("input",{type:"file",accept:".yaml,.yml",style:{display:"none"},ref:l,onChange:e=>{var a;let s=null==(a=e.target.files)?void 0:a[0];if(!s)return;let r=s.name.toLowerCase();if(![".yaml",".yml"].some(e=>r.endsWith(e))){n.oR.error("Only .yaml or .yml files are allowed."),l.current.value="";return}let i=new FileReader;i.onload=e=>{var a;let s=null==(a=e.target)?void 0:a.result;if("string"==typeof s){if(0===s.trim().length){n.oR.error("Uploaded YAML file is empty."),l.current.value="";return}t.current.setValue(s)}},i.readAsText(s)}}),(0,a.jsx)(M.A,{type:"info",children:e.yaml?"Export your rules to a YAML document":"Import rules from a YAML document. This will override your current rules"}),(0,a.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,a.jsx)("label",{htmlFor:"editor-field",className:"text-label",children:"Rules YAML"}),e.yaml?(0,a.jsx)("button",{onClick:i,title:"Copy YAML","aria-label":"Copy YAML",children:(0,a.jsx)(ea.A,{className:"h-5 w-5 text-amber-600 hover:text-amber-500"})}):(0,a.jsx)("button",{onClick:()=>{var e;return null==(e=l.current)?void 0:e.click()},title:"Upload YAML","aria-label":"Upload YAML",children:(0,a.jsx)("span",{className:"flex justify-center font-semibold text-amber-600 hover:text-amber-500",children:(0,a.jsx)(el,{className:"h-5 w-5"})})})]}),(0,a.jsx)(es.Ay,{options:{minimap:{enabled:!1},...e.yaml?{readOnly:!0}:void 0},height:"70vh",defaultLanguage:"yaml",theme:"vs-dark",...e.yaml?{defaultValue:e.yaml}:void 0,onMount:function(e,l){t.current=e}})]})})};var en=l(31974);let ei=r.forwardRef(function(e,t){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),r.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),r.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"}))}),eo=e=>(0,a.jsxs)("div",{className:"section mb-4 mt-4 h-full w-full",children:[(0,a.jsx)("h3",{className:"sm-heading flex max-w-6xl",children:e.id?"".concat(e.name," #").concat(e.id):"".concat(e.name," #1")}),e.description?(0,a.jsx)("p",{className:"description",children:e.description}):void 0]});var ec=l(82851),ed=l.n(ec),em=function(e){return e[e.NUMBER=0]="NUMBER",e[e.DATE=1]="DATE",e[e.TEXT=2]="TEXT",e[e.BOOL=3]="BOOL",e[e.TEXT_LIST=4]="TEXT_LIST",e}(em||{}),eu=function(e){return e[e.AND=0]="AND",e[e.OR=1]="OR",e}(eu||{}),ex=function(e){return e.CUSTOM_NUMBER="custom_number",e.CUSTOM_DAYS="custom_days",e.CUSTOM_DATE="custom_date",e.CUSTOM_TEXT="custom_text",e.CUSTOM_TEXT_LIST="custom_text_list",e.CUSTOM_BOOLEAN="custom_boolean",e}(ex||{});function eh(e){let{ruleType:t,action:l}=e;if(null!=l&&4===t)return[i.COUNT_EQUALS,i.COUNT_NOT_EQUALS,i.COUNT_BIGGER,i.COUNT_SMALLER].includes(l)?(0,a.jsx)("option",{value:"custom_number",children:"Count (number)"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"custom_text",children:"Text"}),(0,a.jsx)("option",{hidden:!0,value:"custom_text_list",children:"Text (legacy list option)"})]})}let ef=e=>{var t,l;let s=(0,r.useContext)(m),[n,d]=(0,r.useState)(),[u,x]=(0,r.useState)(),[h,f]=(0,r.useState)(),[v,p]=(0,r.useState)(),[b,g]=(0,r.useState)(),[j,y]=(0,r.useState)(),[N,w]=(0,r.useState)(!0),[S,A]=(0,r.useState)([]),[k,T]=(0,r.useState)(0);(0,r.useEffect)(()=>{var t,l,a;if(null==(t=e.editData)?void 0:t.rule){if(d(null==(l=e.editData.rule.operator)?void 0:l.toString()),x(JSON.stringify(e.editData.rule.firstVal)),f(e.editData.rule.action),e.editData.rule.customVal){switch(e.editData.rule.customVal.ruleTypeId){case 0:e.editData.rule.customVal.value%86400==0&&0!=e.editData.rule.customVal.value?p("custom_days"):p("custom_number"),T(0);break;case 1:p("custom_date"),T(1);break;case 2:p("custom_text"),T(2);break;case 3:p("custom_boolean"),T(3);break;case 4:p("custom_text_list"),T(4)}y(e.editData.rule.customVal.value.toString())}else p(JSON.stringify(e.editData.rule.lastVal));e.id&&e.newlyAdded&&(null==(a=e.newlyAdded)?void 0:a.includes(e.id))&&(d(void 0),x(void 0),f(void 0),p(void 0),y(void 0))}},[]);let z=e=>{"custom_days"===v?y((86400*e.target.value).toString()):y(e.target.value)},_=t=>{if(t&&t.preventDefault(),u&&null!=h&&(v&&"custom_date"!==v&&"custom_days"!==v&&"custom_number"!==v&&"custom_text"!==v&&"custom_text_list"!==v&&"custom_boolean"!==v||j)){let t={operator:n||null,firstVal:JSON.parse(u),action:h,section:e.section?e.section-1:0};j?e.onCommit(e.id?e.id:0,{customVal:{ruleTypeId:N?1===b||0===b?b:2===b&&"custom_days"===v?0:2===b||3===b||4===b?b:+k:+k,value:j},...t}):e.onCommit(e.id?e.id:0,{lastVal:JSON.parse(v),...t})}else e.onIncomplete(e.id?e.id:0)};(0,r.useEffect)(()=>{_(null)},[v,j,n,h,u,b]),(0,r.useEffect)(()=>{var t,l;let a=null==(t=ed().cloneDeep(s.constants.applications))?void 0:t.map(t=>(t.props=t.props.filter(t=>(t.mediaType===c.BOTH||e.mediaType===t.mediaType)&&(e.mediaType===c.MOVIE||void 0===t.showType||t.showType.includes(e.dataType))),t));if(u){let e=JSON.parse(u),t=e[0];(null==a||null==(l=a[t])?void 0:l.props.find(t=>t.id==e[1]))||x(void 0)}},[e.dataType,e.mediaType]),(0,r.useEffect)(()=>{if(u){let e=R(u);(null==e?void 0:e.type.key)&&(S.length<=0?(T(+(null==e?void 0:e.type.key)),A(e.type.possibilities)):+e.type.key!==k&&(p(void 0),y(""),T(+(null==e?void 0:e.type.key)),A(e.type.possibilities)))}},[u]),(0,r.useEffect)(()=>{v&&("custom_number"===v?(w(!0),g(0)):"custom_date"===v?(w(!0),g(1)):"custom_days"===v||"custom_text"===v?(w(!0),g(2)):"custom_text_list"===v?(w(!0),g(4)):"custom_boolean"===v?(w(!0),g(3),"0"!==j&&y("1")):(w(!1),y(void 0)))},[v]);let R=e=>{var t;"string"==typeof e&&(e=JSON.parse(e));let l=null==(t=s.constants.applications)?void 0:t.find(t=>t.id===+e[0]);return null==l?void 0:l.props.find(t=>t.id===+e[1])};return(0,a.jsxs)("div",{className:"w-full rounded-2xl bg-zinc-800 p-4 text-zinc-100 shadow-lg",onSubmit:_,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-amber-600",children:e.tagId?"Rule #".concat(e.tagId):e.id?"Rule #".concat(e.id):"Rule #1"}),e.allowDelete?(0,a.jsxs)("button",{className:"flex items-center rounded-lg bg-red-600 px-3 py-1 text-zinc-100 shadow-md hover:bg-red-500",onClick:t=>{null==t||t.preventDefault(),e.onDelete(e.section?e.section:0,e.id?e.id:0)},title:"Remove rule ".concat(e.tagId,", section ").concat(e.section),children:[(0,a.jsx)(C.A,{className:"mr-1 h-5 w-5"}),"Delete"]}):null]}),1!==e.id&&(e.id&&e.id>0||e.section&&e.section>1)?(0,a.jsxs)("div",{className:"mb-3 mt-2 md:flex md:items-center",children:[e.id&&(e.tagId?1!==e.tagId:1!==e.id)?(0,a.jsx)("label",{htmlFor:"operator",children:"Operator"}):(0,a.jsx)("label",{htmlFor:"operator",children:"Section Operator"}),(0,a.jsx)("div",{className:"md:ml-4",children:(0,a.jsx)("div",{className:"flex w-1/2 md:w-fit",children:(0,a.jsxs)("select",{name:"operator",id:"operator",onChange:e=>{d(e.target.value)},value:n,children:[(0,a.jsx)("option",{value:void 0,children:" "}),Object.keys(eu).map((e,t)=>{if(!isNaN(+e))return(0,a.jsx)("option",{value:t,children:eu[t]},t)})]})})})]}):void 0,(0,a.jsxs)("div",{className:"mt-1 grid grid-cols-1 gap-x-3 gap-y-3 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"first_val",className:"block text-sm font-medium",children:"First Value"}),(0,a.jsxs)("select",{name:"first_val",id:"first_val",onChange:e=>{x(e.target.value)},value:u,className:"w-full rounded-lg p-2 text-zinc-100 focus:border-amber-500 focus:ring-amber-500",children:[(0,a.jsx)("option",{value:void 0,className:"text-amber-600",children:"Select First Value..."}),null==(t=s.constants.applications)?void 0:t.map(t=>t.mediaType===c.BOTH||e.mediaType===t.mediaType?(0,a.jsx)("optgroup",{label:t.name,children:t.props.map(l=>(l.mediaType===c.BOTH||e.mediaType===l.mediaType)&&(e.mediaType===c.MOVIE||void 0===l.showType||l.showType.includes(e.dataType))?(0,a.jsx)("option",{value:JSON.stringify([t.id,l.id]),children:"".concat(t.name," - ").concat(l.humanName)},"".concat(t.id,"-").concat(l.id)):null)},t.id):null)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"action",className:"mb-1 block text-sm font-medium",children:"Action"}),(0,a.jsxs)("select",{name:"action",id:"action",onChange:e=>{f(+e.target.value)},value:h,className:"w-full rounded-lg p-2 text-zinc-100 focus:border-amber-500 focus:ring-amber-500",children:[(0,a.jsx)("option",{value:void 0,className:"text-amber-600",children:"Select Action..."}),S.map(e=>(0,a.jsx)("option",{value:e,children:o[e]},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"second_val",className:"mb-1 block text-sm font-medium",children:"Second Value"}),(0,a.jsxs)("select",{name:"second_val",id:"second_val",onChange:e=>{p(e.target.value)},value:v,className:"w-full rounded-lg p-2 text-zinc-100 focus:border-amber-500 focus:ring-amber-500",children:[(0,a.jsx)("option",{value:void 0,className:"text-amber-600",children:"Select Second Value..."}),(0,a.jsxs)("optgroup",{label:"Custom values",children:[1===k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"custom_days",children:"Amount of days"}),null!=h&&h!==i.IN_LAST&&h!==i.IN_NEXT?(0,a.jsx)("option",{value:"custom_date",children:"Specific date"}):void 0]}):void 0,0===k?(0,a.jsx)("option",{value:"custom_number",children:"Number"}):void 0,3===k?(0,a.jsx)("option",{value:"custom_boolean",children:"Boolean"}):void 0,2===k?(0,a.jsx)("option",{value:"custom_text",children:"Text"}):void 0,(0,a.jsx)(eh,{ruleType:k,action:h})]}),null==(l=s.constants.applications)?void 0:l.map(t=>(t.mediaType===c.BOTH||e.mediaType===t.mediaType)&&null!=h&&h!==i.IN_LAST&&h!==i.IN_NEXT?(0,a.jsx)("optgroup",{label:t.name,children:t.props.map(l=>{for(let s of function(e){return 4===e||2===e?[2,4]:[e]}(k))if(+l.type.key===s)return(l.mediaType===c.BOTH||e.mediaType===l.mediaType)&&(e.mediaType===c.MOVIE||void 0===l.showType||l.showType.includes(e.dataType))?(0,a.jsx)("option",{value:JSON.stringify([t.id,l.id]),children:"".concat(t.name," - ").concat(l.humanName)},t.id+10+l.id):void 0})},t.id):void 0)]})]}),N?(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{htmlFor:"custom_val",className:"mb-1 block text-sm font-medium",children:"Custom Value"}),2===b&&"custom_days"===v?(0,a.jsx)("input",{type:"number",name:"custom_val",id:"custom_val",onChange:z,value:j?j/86400:void 0,placeholder:"Amount of days"}):2===b&&"custom_text"===v||4===b?(0,a.jsx)("input",{type:"text",name:"custom_val",id:"custom_val",onChange:z,value:j,placeholder:"Text"}):1===b?(0,a.jsx)("input",{type:"date",name:"custom_val",id:"custom_val",onChange:z,value:j,placeholder:"Date"}):3===b?(0,a.jsxs)("select",{name:"custom_val",id:"custom_val",onChange:z,value:j,children:[(0,a.jsx)("option",{value:1,children:"True"}),(0,a.jsx)("option",{value:0,children:"False"})]}):(0,a.jsx)("input",{type:"number",name:"custom_val",id:"custom_val",onChange:z,value:j,placeholder:"Number"})]}):null]})]})},ev=e=>{let t=0,l=0,a=e[0],s=[[],[[]]];for(;++t<=a;)s[0].push(t),t>1&&s[1].push([]);for(let t of s[0])for(l=0;++l<=e[1][t-1];)s[1][t-1].push(l);return s},ep=e=>{let t=e.editData&&e.editData.rules.length>0?e.editData.rules[e.editData.rules.length-1].section+1:void 0,l=t?((e,t)=>{let l=[];return e&&e.rules.forEach(e=>void 0!==e.section?l[e.section]?l[e.section]++:l[e.section]=1:l[0]=1),[t,l.filter(e=>null!=e)]})(e.editData,t):[1,[1]],[s,n]=(0,r.useState)(l),[i,o]=(0,r.useState)(e.editData),[c,d]=(0,r.useState)(ev(l)),m=(0,r.useRef)([]),u=(0,r.useRef)(0),x=(0,r.useRef)(t?[]:[1]),h=(t,l)=>{if(m){let a=[...m.current.filter(e=>e.id!==t),{id:t,rule:l}].sort((e,t)=>e.id-t.id);m.current=a,e.onUpdate(m.current.map(e=>e.rule)),x.current=x.current.filter(e=>e!==t)}},f=t=>{if(m){var l;let a=null==(l=m.current)?void 0:l.filter(e=>e.id!==t);m.current=[...a],e.onUpdate(m.current.map(e=>e.rule))}},v=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1?arguments[1]:void 0;if(m.current.length>0){var a;let s=null==(a=m.current)?void 0:a.filter(e=>e.id!==l),r=!s.some(e=>0===e.rule.section);m.current=[...s=s.map(e=>(e.id=e.id>l?e.id-1:e.id,r&&1===t&&e.rule.section&&(e.rule.section-=1),e))],e.onUpdate(m.current.map(e=>e.rule))}x.current=x.current.filter(e=>e!==l).map(e=>e=e>l?e-1:e),o({rules:m.current.map(e=>e.rule)});let r=[...s[1]];r[t-1]=r[t-1]-1;let n=r.filter(e=>e>0);p([n.length,n.length>0?n:[1]]),u.current=u.current+1},p=e=>{d(ev(e)),n(e)};return(0,a.jsxs)("div",{className:"text-zinc-100",children:[c[0].map(t=>(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"rounded-lg bg-zinc-700 px-6 py-0.5 shadow-md",children:[(0,a.jsx)(eo,{id:t,name:"Section"}),(0,a.jsx)("div",{className:"flex flex-col space-y-2",children:c[1][t-1].map((l,r)=>(0,a.jsx)("div",{className:"flex w-full flex-col items-start",children:(0,a.jsx)("div",{className:"mb-4 w-full",children:(0,a.jsx)(ef,{id:s[1].length>1?s[1].reduce((e,a,s)=>1===t?a-(a-l):s<=t-1?s===t-1?a-(a-l)+e:a+e:e):s[1][0]-(s[1][0]-l),tagId:l,editData:i?{rule:i.rules[(s[1].length>1?s[1].reduce((e,a,s)=>1===t?a-(a-l):s<=t-1?s===t-1?a-(a-l)+e:a+e:e):s[1][0]-(s[1][0]-l))-1]}:void 0,section:t,newlyAdded:x.current,mediaType:e.mediaType,dataType:e.dataType,onCommit:h,onIncomplete:f,onDelete:v,allowDelete:s[0]>1||s[1][t-1]>1},"".concat(t,"-").concat(l))})},"".concat(t,"-").concat(l)))}),x.current.length<=0?(0,a.jsx)("div",{className:"mb-2 flex w-full justify-end",children:(0,a.jsxs)("button",{type:"button",className:"flex h-8 rounded bg-amber-600 text-zinc-200 shadow-md hover:bg-amber-500",onClick:()=>(e=>{let t=s[1].reduce((t,l,a)=>a+1<=e?t+l:t)+1;x.current=[...x.current,t],m.current.map(e=>(e.id>=t&&(e.id=e.id+1),e));let l=[...s[1]];l[e-1]=l[e-1]+1,p([s[0],l])})(t),title:"Add a new rule to Section ".concat(t),children:[(0,a.jsx)(en.A,{className:"m-auto ml-5 h-5"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-5 text-zinc-200",children:"Add Rule"})]})}):null]})},"".concat(t,"-").concat(u.current))),x.current.length<=0?(0,a.jsx)("div",{className:"mb-3 mt-3 flex w-full",children:(0,a.jsx)("div",{className:"m-auto xl:m-0",children:(0,a.jsxs)("button",{type:"button",className:"flex h-8 rounded bg-amber-600 text-zinc-200 shadow-md hover:bg-amber-500",onClick:e=>{let t=[...s[1]];t.push(1);let l=s[1].reduce((e,t,l)=>l+1<=s[0]+1?e+t:e)+1;x.current=[...x.current,l],p([s[0]+1,t])},title:"Add a new section",children:[(0,a.jsx)(ei,{className:"m-auto ml-5 h-5"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-5 text-zinc-200",children:"New Section"})]})})}):void 0,m.current.length!==s[1].reduce((e,t)=>e+t)?(0,a.jsx)("div",{className:"max-width-form-head mt-5",children:(0,a.jsxs)(M.A,{children:["Some incomplete rules won't be saved"," "]})}):void 0]})},eb=e=>{var t,l,s;let n=void 0===e.settingId?"-1":null!=(l=null==(t=e.settingId)?void 0:t.toString())?l:"",[i,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),m=null!=(s=e.arrAction)?s:0,u=t=>{let l=null==t?0:m;e.onUpdate(l,t)},x=async t=>{d(!0),o([]);let l=await (0,h.Ay)("/settings/".concat(t.toLowerCase()));o(l),d(!1),e.settingId&&null==l.find(t=>t.id===e.settingId)&&u(void 0)};(0,r.useEffect)(()=>{x(e.type)},[e.type]);let f=""===n,v=f?[{id:0,name:"Delete"},{id:4,name:"Do nothing"}]:e.options;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsxs)("label",{htmlFor:"".concat(e.type,"-server"),className:"text-label",children:[e.type," server *"]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsxs)("select",{name:"".concat(e.type,"-server"),id:"".concat(e.type,"-server"),value:n,onChange:e=>{u(""==e.target.value?null:+e.target.value)},children:["-1"===n&&(0,a.jsx)("option",{value:"-1",disabled:!0}),(0,a.jsx)("option",{value:"",children:"None"}),i.map(e=>(0,a.jsx)("option",{value:e.id,children:e.serverName},e.id)),c&&(0,a.jsx)("option",{value:"",disabled:!0,children:"Loading servers..."})]})})})]}),(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsxs)("label",{htmlFor:"".concat(e.type,"-action"),className:"text-label",children:[f?"Plex":e.type," action"]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("select",{name:"".concat(e.type,"-action"),id:"".concat(e.type,"-action"),value:m,onChange:t=>{var l;l=+t.target.value,e.onUpdate(l,e.settingId)},children:v.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})})})]})]})};var eg=l(66964);let ej=e=>{let[t,l]=(0,r.useState)(),[s,n]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(0,h.Ay)("/notifications/configurations").then(t=>{l(t),e.selectedAgents&&n(e.selectedAgents),o(!1)})},[]),(0,a.jsx)(W.A,{loading:i,backgroundClickable:!1,onCancel:()=>e.onCancel(),okDisabled:!1,onOk:()=>e.onSuccess(s),okText:"OK",okButtonType:"primary",title:"Notification Agents",iconSvg:"",children:(0,a.jsx)("div",{children:(0,a.jsx)("form",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)("label",{htmlFor:"name",className:"text-label",children:"Agents"}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field flex flex-col gap-2",children:!i&&t.map(e=>(0,a.jsx)(eg.A,{label:"".concat(e.name," - ").concat(e.agent," ").concat(e.enabled?"":" (disabled)"),toggled:!!s.find(t=>t.id===e.id),onStateChange:t=>{t?n([...s,e]):n([...s.filter(t=>t.id!==e.id)])}},e.id))})})]})})})})};var ey=l(65364);let eN=e=>{var t,l,s,i,o,c,u,x,f,v;let[p,b]=(0,r.useState)(e.editData?e.editData.libraryId.toString():""),[g,j]=(0,r.useState)((null==(t=e.editData)?void 0:t.type)?e.editData.type.toString():""),[y,w]=(0,r.useState)(),[C,S]=(0,r.useState)(),[E,I]=(0,r.useState)(!0),[F,B]=(0,r.useState)(!1),[V,P]=(0,r.useState)(!1),[H,X]=(0,r.useState)(!1),J=(0,r.useRef)(void 0),W=(0,r.useRef)(void 0),G=(0,r.useRef)(void 0),Y=(0,r.useRef)(void 0),Q=(0,r.useRef)(void 0),q=(0,r.useRef)(void 0),K=(0,r.useRef)(void 0),$=(0,r.useRef)("My custom collection"),[Z,ee]=(0,r.useState)(!0),[el,ea]=(0,r.useState)(!0),[es,en]=(0,r.useState)(!0),[ei,eo]=(0,r.useState)(!1),[ec,ed]=(0,r.useState)(!1),[em,eu]=(0,r.useState)(void 0),ex=(0,r.useContext)(m),[eh,ef]=(0,r.useState)((null==(l=e.editData)?void 0:l.notifications)?null==(s=e.editData)?void 0:s.notifications:[]),[ev,eg]=(0,r.useState)(!e.editData||e.editData.useRules),[eN,ew]=(0,r.useState)(),[eC,eS]=(0,r.useState)(e.editData?null:void 0),[eA,ek]=(0,r.useState)(e.editData?null:void 0),[eT,ez]=(0,r.useState)(!e.editData||e.editData.isActive),[e_,eR]=(0,r.useState)(e.editData?e.editData.rules.map(e=>JSON.parse(e.ruleJson)):[]),[eE,eO]=(0,r.useState)(!1),[eI,eL]=(0,r.useState)(!1),eD=(0,r.useRef)(1),eM=(0,r.useContext)(N.A),eU=null!=(x=null==(i=ex.constants.applications)?void 0:i.some(e=>e.id==d.TAUTULLI))&&x,eF=null!=(f=null==(o=ex.constants.applications)?void 0:o.some(e=>e.id==d.OVERSEERR))&&f;function eB(e){ew(e),void 0===e||4===e?eu(void 0):void 0===em&&eu(30)}let eV=(e,t,l)=>{eB(t),"Radarr"===e?(ek(void 0),eS(l)):"Sonarr"===e&&(eS(void 0),ek(l))};function eP(e){eR(e)}let eH=async e=>{let t=await (0,h.vI)("/rules/yaml/encode",{rules:JSON.stringify(e_),mediaType:g});1===t.code&&(J.current=t.result,V?P(!1):P(!0))},eX=async e=>{let t=await (0,h.vI)("/rules/yaml/decode",{yaml:e,mediaType:g});t&&1===t.code?(eJ(JSON.parse(t.result).rules),n.oR.success("Successfully imported rules from Yaml.",{autoClose:5e3})):n.oR.error(t.message,{autoClose:5e3})},eJ=e=>{eP(e),eD.current=eD.current+1,B(!1)},eW=()=>{e.onCancel()};if((0,r.useEffect)(()=>{I(!0),(async()=>{let t=(0,h.Ay)("/rules/constants"),l=eM.libraries.length<=0?(0,h.Ay)("/plex/libraries/"):Promise.resolve(null),a=e.editData?(0,h.Ay)("/collections/collection/".concat(e.editData.collectionId)):Promise.resolve(null),[s,r,n]=await Promise.all([t,l,a]);if(ex.setConstants(s),null!=r&&(r?eM.addLibraries(r):eM.addLibraries([])),n){var i,o,c;S(n),ee(n.visibleOnRecommended),ea(n.visibleOnHome),en(n.listExclusions),eo(n.forceOverseerr),ew(n.arrAction),j(n.type.toString()),ed(n.manualCollection),eS(null!=(i=n.radarrSettingsId)?i:null),ek(null!=(o=n.sonarrSettingsId)?o:null),function(e){let t=eM.libraries.find(t=>+t.key==+e);t&&(b(t.key),w(t))}(n.libraryId.toString()),eu(null!=(c=n.deleteAfterDays)?c:void 0)}I(!1)})()},[]),(0,r.useEffect)(()=>(L().beforePopState(()=>(e.onCancel(),window.history.forward(),!1)),()=>{L().beforePopState(()=>!0)}),[]),E){let e=null!=(v=ey.env.NEXT_PUBLIC_BASE_PATH)?v:"";return(0,a.jsx)("span",{children:(0,a.jsx)(O(),{fill:!0,src:"".concat(e,"/spinner.svg"),alt:"Loading..."})})}return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"h-full w-full",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"ml-0",children:(0,a.jsx)("h3",{className:"heading mb-5",children:"Rule Group Settings"})}),(0,a.jsx)("div",{className:"ml-auto",children:(0,a.jsxs)(U.A,{className:"ml-3",buttonType:"default",type:"button",as:"a",target:"_blank",rel:"noopener noreferrer",href:"https://docs.maintainerr.info/latest/Rules",children:[(0,a.jsx)(k,{}),(0,a.jsx)("span",{children:"Help"})]})})]}),eE?(0,a.jsx)(M.A,{children:"Something went wrong saving the group.. Please verify that all values are valid"}):void 0,eI?(0,a.jsx)(M.A,{children:"Not all required (*) fields contain values and at least 1 valid rule is required"}):void 0,(0,a.jsxs)("form",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 xl:grid-cols-2",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("h2",{className:"mb-2 flex justify-center font-semibold text-zinc-100",children:"General"}),(0,a.jsx)("div",{className:"flex w-full flex-col rounded-lg bg-zinc-800 px-3 py-1",children:(0,a.jsxs)("div",{className:"space-y-2 md:p-4",children:[(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsxs)("label",{htmlFor:"name",className:"text-label",children:["Name *",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Will also be the name of the collection in Plex."})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{name:"name",id:"name",type:"text",ref:W,defaultValue:null==(c=e.editData)?void 0:c.name})})})]}),(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsx)("label",{htmlFor:"description",className:"text-label",children:"Description"}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("textarea",{name:"description",id:"description",rows:5,defaultValue:null==(u=e.editData)?void 0:u.description,ref:G})})})]}),(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsx)("label",{htmlFor:"library",className:"text-label",children:"Library *"}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsxs)("select",{name:"library",id:"library",value:p,onChange:e=>(function(e){let t=eM.libraries.find(t=>+t.key==+e);t&&(b(t.key),w(t),j("movie"===t.type?D.R.MOVIES.toString():D.R.SHOWS.toString())),eS(void 0),ek(void 0),eB(0)})(e.target.value),ref:Y,children:[""===p&&(0,a.jsx)("option",{value:"",disabled:!0}),eM.libraries.map(e=>(0,a.jsx)("option",{value:e.key,children:e.title},e.key))]})})})]}),y&&"movie"===y.type&&(0,a.jsx)(eb,{type:"Radarr",arrAction:eN,settingId:eC,onUpdate:(e,t)=>{eV("Radarr",e,t)},options:[{id:0,name:"Delete"},{id:1,name:"Unmonitor and delete files"},{id:3,name:"Unmonitor and keep files"},{id:4,name:"Do nothing"}]}),y&&"movie"!==y.type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsxs)("label",{htmlFor:"type",className:"text-label",children:["Media type*",(0,a.jsx)("p",{className:"text-xs font-normal",children:"The type of TV media rules should apply to"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("select",{name:"type",id:"type",value:g,onChange:function(e){j(e.target.value),eB(0)},ref:Q,children:Object.keys(D.R).filter(e=>isNaN(Number(e))).filter(e=>"MOVIES"!==e).map(e=>(0,a.jsx)("option",{value:D.R[e],children:e[0].toUpperCase()+e.slice(1).toLowerCase()},D.R[e]))})})})]}),(0,a.jsx)(eb,{type:"Sonarr",arrAction:eN,settingId:eA,onUpdate:(e,t)=>{eV("Sonarr",e,t)},options:+g===D.R.SHOWS?[{id:0,name:"Delete entire show"},{id:1,name:"Unmonitor and delete all seasons / episodes"},{id:2,name:"Unmonitor and delete existing seasons / episodes"},{id:3,name:"Unmonitor show and keep files"},{id:4,name:"Do nothing"}]:+g===D.R.SEASONS?[{id:0,name:"Unmonitor and delete season"},{id:2,name:"Unmonitor and delete existing episodes"},{id:3,name:"Unmonitor season and keep files"},{id:4,name:"Do nothing"}]:[{id:0,name:"Unmonitor and delete episode"},{id:3,name:"Unmonitor and keep file"},{id:4,name:"Do nothing"}]})]}),void 0!==eN&&4!==eN&&(0,a.jsxs)("div",{className:"form-row items-center",children:[(0,a.jsxs)("label",{htmlFor:"collection_deleteDays",className:"text-label",children:["Take action after days*",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Duration of days media remains in the collection before deletion/unmonitor"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"number",name:"collection_deleteDays",id:"collection_deleteDays",value:em,onChange:e=>eu(+e.target.value)})})})]})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("h2",{className:"mb-2 flex justify-center font-semibold text-zinc-100",children:"Options"}),(0,a.jsx)("div",{className:"flex w-full flex-col rounded-lg bg-zinc-800 px-3 py-1",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-col p-2 md:my-2 md:border-r-2 md:border-dashed md:border-zinc-700 md:p-4",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"active",className:"text-label",children:["Active",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Will this rule be included in rule runs."})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"is_active",id:"is_active",className:"",defaultChecked:eT,onChange:()=>{ez(!eT)}})})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"collection_visible_library",className:"text-label",children:["Show on library recommended",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Show the collection on the Plex library recommended screen"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"collection_visible_library",id:"collection_visible_library",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",defaultChecked:Z,onChange:()=>{ee(!Z)}})})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"collection_visible",className:"text-label",children:["Show on home",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Show the collection on the Plex home screen"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"collection_visible",id:"collection_visible",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",defaultChecked:el,onChange:()=>{ea(!el)}})})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"list_exclusions",className:"text-label",children:["Add list exclusions",(0,a.jsxs)("p",{className:"text-xs font-normal",children:["Prevent lists to re-add removed"," ",y?y.type:"movie"]})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"list_exclusions",id:"list_exclusions",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",defaultChecked:es,onChange:()=>{en(!es)}})})})]}),eF&&(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"force_overseerr",className:"text-label",children:["Force reset Overseerr record",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Resets the Overseerr record instead of relying on availability-sync"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"force_overseerr",id:"force_overseerr",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",defaultChecked:ei,onChange:()=>{eo(!ei)}})})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"use_rules",className:"text-label",children:["Use rules",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Toggle the rule system"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"use_rules",id:"use_rules",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",defaultChecked:ev,onChange:()=>{eg(!ev)}})})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-4",children:[(0,a.jsxs)("label",{htmlFor:"manual_collection",className:"text-label",children:["Custom collection",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Toggle internal collection system"})]}),(0,a.jsx)("div",{className:"form-input",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"checkbox",name:"manual_collection",id:"manual_collection",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",defaultChecked:ec,onChange:()=>{ed(!ec)}})})})]}),(0,a.jsxs)("div",{className:"flex flex-col ".concat(ec?"":"hidden"," "),children:[(0,a.jsxs)("label",{htmlFor:"manual_collection_name",className:"text-label",children:["Custom collection name",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Collection must exist in Plex"})]}),(0,a.jsx)("div",{className:"py-2",children:(0,a.jsx)("div",{className:"form-input-field",children:(0,a.jsx)("input",{type:"text",name:"manual_collection_name",id:"manual_collection_name",defaultValue:null==C?void 0:C.manualCollectionName,ref:$})})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col p-2 md:p-4",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-2 md:py-4",children:[(0,a.jsxs)("label",{htmlFor:"notifications",className:"text-label",children:["Notifications",(0,a.jsx)("span",{className:"ml-1.5 rounded-full bg-amber-600 px-3 text-white",children:"BETA"})]}),(0,a.jsx)("div",{className:"flex justify-end px-2 py-2",children:(0,a.jsx)("div",{className:"form-input-field w-20",children:(0,a.jsx)(U.A,{buttonType:"default",type:"button",name:"notifications",className:"w-full !bg-amber-600 hover:!bg-amber-500",onClick:()=>{X(!H)},children:"Configure"})})})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-2 md:py-4",children:[(0,a.jsxs)("label",{htmlFor:"collection_logs_months",className:"text-label text-left",children:["Keep logs for months*",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Duration for which collection logs should be retained, measured in months (0 = forever)"})]}),(0,a.jsx)("div",{className:"flex justify-end px-2 py-2",children:(0,a.jsx)("div",{className:"form-input-field w-20",children:(0,a.jsx)("input",{type:"number",name:"collection_logs_months",id:"collection_logs_months",defaultValue:C?C.keepLogsForMonths:6,ref:q})})})]}),eU&&(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between py-2 md:py-4",children:[(0,a.jsxs)("label",{htmlFor:"tautulli_watched_percent_override",className:"text-label text-left",children:["Tautulli watched percent override",(0,a.jsx)("p",{className:"text-xs font-normal",children:"Overrides the configured Watched Percent in Tautulli, which is used to determine when media is counted as watched"})]}),(0,a.jsx)("div",{className:"flex justify-end px-2 py-2",children:(0,a.jsx)("div",{className:"form-input-field w-20",children:(0,a.jsx)("input",{type:"number",min:0,max:100,name:"tautulli_watched_percent_override",id:"tautulli_watched_percent_override",defaultValue:C?C.tautulliWatchedPercentOverride:"",ref:K})})})]})]})]})})]})]}),(0,a.jsx)("hr",{className:"mt-6 h-px border-0 bg-gray-200 dark:bg-gray-700"}),(0,a.jsx)("div",{className:"grid grid-cols-1",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"section ".concat(ev?"":"hidden"," md:w-3/4"),children:[(0,a.jsxs)("div",{className:"section max-w-full",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("div",{className:"ml-0",children:[(0,a.jsx)("h3",{className:"heading",children:"Rules"}),(0,a.jsx)("p",{className:"description",children:"Specify the rules this group needs to enforce"})]}),(0,a.jsx)("div",{className:"ml-auto",children:(0,a.jsxs)("button",{className:"ml-3 flex h-fit rounded bg-amber-900 p-1 text-zinc-900 shadow-md hover:bg-amber-800 md:h-10",onClick:()=>{null==y?alert("Please select a library first."):B(!F)},type:"button",children:[(0,a.jsx)(A,{className:"m-auto ml-4 h-6 w-6 text-zinc-200"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-4 text-zinc-100",children:"Community"})]})})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-center sm:justify-end",children:[(0,a.jsxs)("button",{className:"ml-3 flex h-fit rounded bg-amber-600 p-1 text-sm text-zinc-900 shadow-md hover:bg-amber-500 md:h-10 md:text-base",onClick:e=>{J.current=void 0,V?P(!1):P(!0)},type:"button",children:[(0,a.jsx)(T.A,{className:"m-auto ml-4 h-6 w-6 text-zinc-200 md:h-6"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-4 text-zinc-100",children:"Import"})]}),(0,a.jsxs)("button",{className:"ml-3 flex h-fit rounded bg-amber-900 p-1 text-sm shadow-md hover:bg-amber-800 md:h-10 md:text-base",onClick:eH,type:"button",children:[(0,a.jsx)(z,{className:"m-auto ml-4 h-6 w-6 text-zinc-200"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-4 text-zinc-100",children:"Export"})]})]})]}),F&&y&&(0,a.jsx)(et,{currentRules:e_,type:y.type,onUpdate:eJ,onCancel:()=>B(!1)}),V&&(0,a.jsx)(er,{yaml:J.current?J.current:void 0,onImport:e=>{eX(e),P(!1)},onCancel:()=>{P(!1)}}),H?(0,a.jsx)(ej,{onSuccess:e=>{ef(e),X(!1)},onCancel:()=>{X(!1)},selectedAgents:eh}):void 0,(0,a.jsx)(ep,{mediaType:y?"movie"===y.type?1:2:0,dataType:+g,editData:{rules:e_},onCancel:eW,onUpdate:eP},eD.current)]})})}),(0,a.jsx)("div",{className:"mt-5 flex h-full w-full",children:(0,a.jsxs)("div",{className:"m-auto flex xl:m-0",children:[(0,a.jsxs)("button",{className:"ml-auto mr-3 flex h-10 rounded bg-amber-600 text-zinc-900 shadow-md hover:bg-amber-500",onClick:()=>{if(W.current.value&&Y.current.value&&(void 0!==eC||void 0!==eA)&&(ev&&e_.length>0||!ev)){eL(!1);let t={name:W.current.value,description:G.current.value,libraryId:+Y.current.value,arrAction:eN||0,dataType:+g,isActive:eT,useRules:ev,listExclusions:es,forceOverseerr:ei,tautulliWatchedPercentOverride:K.current&&""!=K.current.value?+K.current.value:void 0,radarrSettingsId:null!=eC?eC:void 0,sonarrSettingsId:null!=eA?eA:void 0,collection:{visibleOnRecommended:Z,visibleOnHome:el,deleteAfterDays:void 0===eN||4===eN?void 0:em,manualCollection:ec,manualCollectionName:$.current.value,keepLogsForMonths:+q.current.value},rules:ev?e_:[],notifications:eh};e.editData?(0,h.gi)("/rules",{id:e.editData.id,...t}).then(t=>{1===t.code?e.onSuccess():eO(!0)}).catch(e=>{eO(!0)}):(0,h.vI)("/rules",t).then(t=>{1===t.code?e.onSuccess():eO(!0)}).catch(e=>{eO(!0)})}else eL(!0)},type:"button",children:[(0,a.jsx)(_.A,{className:"m-auto ml-5 h-6 w-6 text-zinc-200"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-5 text-zinc-100",children:"Save"})]}),(0,a.jsxs)("button",{className:"ml-auto flex h-10 rounded bg-amber-900 text-zinc-900 shadow-md hover:bg-amber-800",onClick:eW,children:[(0,a.jsx)(R,{className:"m-auto ml-5 h-6 w-6 text-zinc-200"}),(0,a.jsx)("p",{className:"button-text m-auto ml-1 mr-5 text-zinc-100",children:"Cancel"})]})]})})]})]})})},ew=()=>{let[e,t]=(0,r.useState)(!1),[l,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(),[d,m]=(0,r.useState)(),[f,j]=(0,r.useState)(9999),[y,N]=(0,r.useState)(!0),{ruleHandlerRunning:w}=(0,x.oy)(),C=async()=>9999===f?await (0,h.Ay)("/rules"):await (0,h.Ay)("/rules?libraryId=".concat(f));(0,r.useEffect)(()=>{document.title="Maintainerr - Rules",C().then(e=>{c(e),N(!1)})},[]),(0,r.useEffect)(()=>{A()},[f]);let A=()=>{C().then(e=>c(e)),t(!1),i(!1)},k=e=>{m(e),i(!0)},T=async()=>{try{await (0,h.vI)("/rules/execute",{}),n.oR.success("Initiated rule execution in the background.")}catch(t){if(t instanceof s.pe){var e;if((null==(e=t.response)?void 0:e.status)===409)return void n.oR.error("Rule execution is already running.")}n.oR.error("Failed to initiate rule execution.")}},z=async()=>{try{await (0,h.vI)("/rules/execute/stop",{}),n.oR.success("Requested to stop rule execution.")}catch(e){n.oR.error("Failed to request stop of rule execution.")}};return!o||y?(0,a.jsx)("span",{children:(0,a.jsx)(g.A,{})}):e?(0,a.jsx)(u,{children:(0,a.jsx)(eN,{onSuccess:A,onCancel:()=>{t(!1)}})}):l?(0,a.jsx)(u,{children:(0,a.jsx)(eN,{onSuccess:A,editData:d,onCancel:()=>{i(!1)}})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(b.A,{onSwitch:e=>{j(e)}}),(0,a.jsxs)("div",{className:"m-auto mb-3 flex",children:[(0,a.jsx)("div",{className:"ml-auto sm:ml-0",children:(0,a.jsx)(v,{onClick:()=>{t(!e)},text:"New Rule"})}),(0,a.jsx)("div",{className:"ml-2 mr-auto sm:mr-0",children:(0,a.jsx)(p.A,{onClick:()=>{w?z():T()},text:w?"Stop Rules":"Run Rules",executing:w})})]}),(0,a.jsx)("h1",{className:"mb-3 text-lg font-bold text-zinc-200",children:"Rules"}),(0,a.jsx)("ul",{className:"xs:collection-cards-vertical",children:o.map(e=>(0,a.jsx)("li",{className:"collection relative mb-5 flex h-fit transform-gpu flex-col rounded-xl bg-zinc-800 bg-cover bg-center p-4 text-zinc-400 shadow ring-1 ring-zinc-700 xs:w-full sm:mb-0 sm:mr-5",children:(0,a.jsx)(S,{onDelete:A,onEdit:k,group:e})},e.id))})]})})},eC=()=>(0,a.jsx)(ew,{})},11684:(e,t,l)=>{"use strict";l.d(t,{A:()=>d});var a=l(37876),s=l(63043),r=l(14232),n=l(98477),i=l(46100),o=l(10291);let c={xs:"sm:max-w-xs",sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl","6xl":"sm:max-w-6xl","7xl":"sm:max-w-7xl"},d=e=>{let{title:t,onCancel:l,onOk:d,cancelText:m,okText:u,okDisabled:x=!1,cancelButtonType:h="default",okButtonType:f="primary",children:v,disableScrollLock:p,backgroundClickable:b=!0,iconSvg:g,loading:j=!1,secondaryButtonType:y="default",secondaryDisabled:N=!1,onSecondary:w,secondaryText:C,tertiaryButtonType:S="default",tertiaryDisabled:A=!1,tertiaryText:k,onTertiary:T,specialButtonType:z="default",specialDisabled:_=!1,specialText:R,onSpecial:E,backdrop:O,size:I="3xl"}=e,L=(0,r.useRef)(null);return((e,t)=>{(0,r.useEffect)(()=>{let l=l=>{e.current&&!e.current.contains(l.target)&&t(l)};return document.body.addEventListener("click",l,{capture:!0}),()=>{document.body.removeEventListener("click",l)}},[e,t])})(L,()=>{"function"==typeof l&&b&&l()}),((e,t)=>{(0,r.useEffect)(()=>{let l=window.getComputedStyle(document.body).overflow;return e&&!t&&(document.body.style.overflow="hidden"),()=>{t||(document.body.style.overflow=l)}},[e,t])})(!0,p),(0,n.createPortal)((0,a.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 top-0 z-50 flex h-full w-full items-center justify-center bg-zinc-800 bg-opacity-70",onKeyDown:e=>{"Escape"===e.key&&"function"==typeof l&&b&&l()},children:[(0,a.jsx)(s.e,{as:"div",className:"absolute",enter:"transition opacity-0 duration-1000 transform scale-75",enterFrom:"opacity-0 scale-75",enterTo:"opacity-100 scale-100",leave:"transition opacity-100 duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",show:j,children:(0,a.jsx)(o.A,{})}),(0,a.jsxs)(s.e,{appear:!0,as:"div",className:"relative inline-block w-full transform overflow-auto bg-zinc-700 px-4 pb-4 pt-5 text-left align-bottom shadow-xl ring-1 ring-zinc-700 transition duration-300 sm:my-8 ".concat(c[I]," sm:rounded-lg sm:align-middle"),enterFrom:"scale-75 opacity-0",enterTo:"scale-100 opacity-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",show:!j,role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline",style:{maxHeight:"calc(100% - env(safe-area-inset-top) * 2)"},ref:L,children:[(0,a.jsxs)("div",{className:"relative overflow-x-hidden sm:flex sm:items-center",children:[g&&(0,a.jsx)("div",{className:"modal-icon",children:g}),(0,a.jsx)("div",{className:"mt-3 truncate text-center text-white sm:mt-0 sm:text-left ".concat(g?"sm:ml-4":"sm:mb-4"),children:t&&(0,a.jsx)("span",{className:"truncate text-lg font-bold leading-6",id:"modal-headline",children:t})})]}),v&&(0,a.jsx)("div",{className:"relative mt-4 text-sm leading-5 text-zinc-300",children:v}),"function"==typeof E&&(0,a.jsx)("div",{className:"mt-4 flex justify-center sm:justify-end",children:(0,a.jsx)(i.A,{buttonType:z,onClick:E,className:"ml-3",children:R||"Special"})}),(l||d||w||T)&&(0,a.jsxs)("div",{className:"relative mt-5 flex flex-row-reverse justify-center sm:mt-4 sm:justify-start",children:["function"==typeof d&&(0,a.jsx)(i.A,{buttonType:f,onClick:d,className:"ml-3",disabled:x,children:u||"Ok"}),"function"==typeof w&&C&&(0,a.jsx)(i.A,{buttonType:y,onClick:w,className:"ml-3",disabled:N,children:C}),"function"==typeof T&&k&&(0,a.jsx)(i.A,{buttonType:S,onClick:T,className:"ml-3",disabled:A,children:k}),"function"==typeof l&&(0,a.jsx)(i.A,{buttonType:h,onClick:l,className:"ml-3",children:m||"Cancel"})]})]})]}),document.body)}},32105:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/rules",function(){return l(10815)}])},33444:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"}))})},36572:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(37876),s=l(6555),r=l(1660),n=l(86054);l(14232);let i=e=>{let{title:t,children:l,type:i}=e,o={bgColor:"bg-zinc-800",titleColor:"text-zinc-100",textColor:"text-zinc-300",svg:(0,a.jsx)(s.A,{className:"h-5 w-5"})};switch(i){case"info":o={bgColor:"bg-zinc-800",titleColor:"text-zinc-100",textColor:"text-zinc-300",svg:(0,a.jsx)(r.A,{className:"h-5 w-5"})};break;case"error":o={bgColor:"bg-red-600",titleColor:"text-red-100",textColor:"text-red-300",svg:(0,a.jsx)(n.A,{className:"h-5 w-5"})}}return(0,a.jsx)("div",{className:"mb-4 rounded-md p-4 ".concat(o.bgColor),children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0 ".concat(o.titleColor),children:o.svg}),(0,a.jsxs)("div",{className:"ml-3",children:[t&&(0,a.jsx)("div",{className:"text-sm font-medium ".concat(o.titleColor),children:t}),l&&(0,a.jsx)("div",{className:"button-text mt-2 text-sm first:mt-0 ".concat(o.textColor),children:l})]})]})})}},46100:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(37876);let s=l(14232).forwardRef(function(e,t){let{buttonType:l="default",buttonSize:s="default",as:r,children:n,className:i,...o}=e,c=["inline-flex items-center justify-center border border-transparent leading-5 font-medium focus:outline-none transition ease-in-out duration-150 cursor-pointer disabled:opacity-50 whitespace-nowrap"];switch(l){case"primary":c.push("text-white bg-amber-600 border-amber-600 hover:bg-amber-500 hover:border-amber-500 rounded-md focus:border-amber-700 focus:ring-amber active:bg-amber-700 active:border-amber-700");break;case"danger":c.push("text-white bg-red-600 border-red-600 hover:bg-red-500 hover:border-red-500 focus:border-red-700 rounded-md focus:ring-red active:bg-red-700 active:border-red-700");break;case"warning":c.push("text-white bg-zinc-800 border-zinc-800 hover:bg-zinc-600 hover:border-zinc-600 focus:border-zinc-700 rounded-md focus:ring-zinc active:bg-zinc-700 active:border-zinc-700");break;case"success":c.push("text-white bg-amber-900 border-amber-900 hover:bg-amber-700 hover:border-amber-700 focus:border-amber-700 rounded-md focus:ring-amber active:bg-amber-700 active:border-amber-700");break;case"ghost":c.push("text-white bg-transaprent border-zinc-600 hover:border-zinc-200 focus:border-zinc-100 rounded-md active:border-zinc-100");break;case"twin-primary-l":c.push("text-white bg-amber-600 border-amber-600 hover:bg-amber-500 hover:border-amber-500 focus:border-amber-700 focus:ring-amber active:bg-amber-700 active:border-amber-700 rounded-l");break;case"twin-primary-r":c.push("text-white bg-amber-600 border-amber-600 hover:bg-amber-500 hover:border-amber-500 focus:border-amber-700 focus:ring-amber active:bg-amber-700 active:border-amber-700 rounded-r");break;case"twin-secondary-l":c.push("text-white bg-amber-900 border-amber-900 hover:bg-amber-700 hover:border-amber-700 focus:border-amber-700 focus:ring-amber active:bg-amber-700 active:border-amber-700 rounded-l");break;case"twin-secondary-r":c.push("text-white bg-amber-900 border-amber-900 hover:bg-amber-700 hover:border-amber-700 focus:border-amber-700 focus:ring-amber active:bg-amber-700 active:border-amber-700 rounded-r");break;default:c.push("text-zinc-200 bg-zinc-600 border-zinc-600 hover:text-white hover:bg-zinc-500 hover:border-zinc-500 group-hover:text-white rounded-md group-hover:bg-zinc-500 group-hover:border-zinc-500 focus:border-amber-600 focus:ring-amber active:text-zinc-200 active:bg-zinc-500 active:border-zinc-500")}switch(s){case"sm":c.push("px-2.5 py-1.5 text-xs button-sm");break;case"lg":c.push("px-6 py-3 text-base button-lg");break;default:c.push("px-4 py-2 text-sm button-md")}return(c.push(null!=i?i:""),"a"===r)?(0,a.jsx)("a",{className:c.join(" "),...o,ref:t,children:(0,a.jsx)("span",{className:"flex items-center",children:n})}):(0,a.jsx)("button",{className:c.join(" "),...o,ref:t,children:(0,a.jsx)("span",{className:"flex items-center",children:n})})})},48711:(e,t,l)=>{"use strict";l.d(t,{pe:()=>s});let{Axios:a,AxiosError:s,CanceledError:r,isCancel:n,CancelToken:i,VERSION:o,all:c,Cancel:d,isAxiosError:m,spread:u,toFormData:x,AxiosHeaders:h,HttpStatusCode:f,formToJSON:v,getAdapter:p,mergeConfig:b}=l(91040).A},57353:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{d:"M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"}))})},66964:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var a=l(37876),s=l(14232);let r=e=>{let{label:t,toggled:l,onStateChange:r}=e,[n,i]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{void 0!==l&&i(l)},[]),(0,a.jsx)("div",{className:"flex items-center justify-between border-b border-gray-700 py-2",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",checked:n,onChange:()=>{r(!n),i(!n)}}),(0,a.jsx)("span",{className:"toggle-label block h-6 cursor-pointer overflow-hidden rounded-full bg-gray-400"}),(0,a.jsx)("span",{className:"ml-3 text-white",children:t})]})})}},77834:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"}))})},86054:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))})},90525:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{d:"M8 2a1 1 0 000 2h2a1 1 0 100-2H8z"}),a.createElement("path",{d:"M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11h2a1 1 0 110 2h-2v-2z"}))})},91710:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(37876),s=l(14232),r=l(91104),n=l(41568);let i=e=>{let t=(0,s.useContext)(r.A);return(0,s.useEffect)(()=>{t.libraries.length<=0&&(0,n.Ay)("/plex/libraries").then(l=>{l?(t.addLibraries(l),void 0===e.allPossible||e.allPossible||e.onSwitch(+l[0].key)):t.addLibraries([])})},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"mb-5 w-full",children:(0,a.jsx)("form",{children:(0,a.jsxs)("select",{className:"border-zinc-600 hover:border-zinc-500 focus:border-zinc-500 focus:bg-opacity-100 focus:placeholder-zinc-400 focus:outline-none focus:ring-0",onChange:t=>{e.onSwitch(+t.target.value)},children:[void 0===e.allPossible||e.allPossible?(0,a.jsx)("option",{value:9999,children:"All"}):void 0,t.libraries.map(e=>(0,a.jsx)("option",{value:e.key,children:e.title},e.key))]})})})})}},94035:(e,t,l)=>{"use strict";l.d(t,{R:()=>a});var a=function(e){return e[e.MOVIES=1]="MOVIES",e[e.SHOWS=2]="SHOWS",e[e.SEASONS=3]="SEASONS",e[e.EPISODES=4]="EPISODES",e}({})},95932:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(14232);let s=a.forwardRef(function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"}))})},98587:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var a=l(37876),s=l(77834),r=l(10291);let n=e=>(0,a.jsxs)("button",{className:"edit-button m-auto flex h-9 rounded text-zinc-200 shadow-md",onClick:e.onClick,disabled:e.disabled,children:[e.executing?(0,a.jsx)(r.r,{className:"m-auto ml-2 h-5"}):(0,a.jsx)(s.A,{className:"m-auto ml-4 h-5"})," ",(0,a.jsx)("p",{className:"rules-button-text m-auto ml-1 mr-4",children:e.text})]})}},e=>{e.O(0,[888,488,636,593,792],()=>e(e.s=32105)),_N_E=e.O()}]);